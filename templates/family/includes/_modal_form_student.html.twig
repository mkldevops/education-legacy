{% trans_default_domain 'family' %}

<div x-data="{ showModal: false }">
    <button type="button" @click="showModal = true" class="inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors duration-200">
        {{ ux_icon('tabler:user-plus', {class: 'w-4 h-4 mr-2'}) }}
        {{ 'new_student'|trans }}
    </button>

    <!-- Modal -->
    <div x-show="showModal" @click.away="showModal = false" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" class="fixed inset-0 z-50 overflow-y-auto" style="display: none;">
        <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>
            
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen">&#8203;</span>
            
            <div @click.stop class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full">
                <div class="px-6 py-4 border-b border-gray-200">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <div class="bg-blue-100 rounded-full p-2 mr-3">
                                {{ ux_icon('tabler:user-plus', {class: 'w-5 h-5 text-blue-600'}) }}
                            </div>
                            <h4 class="text-lg font-medium text-gray-900">{{ 'new_student'|trans }}</h4>
                        </div>
                        <button type="button" @click="showModal = false" class="text-gray-400 hover:text-gray-600 focus:outline-none focus:text-gray-600 transition ease-in-out duration-150">
                            {{ ux_icon('tabler:x', {class: 'w-6 h-6'}) }}
                        </button>
                    </div>
                </div>

            {{ form_start(formStudent, {"attr": {"class": "space-y-6"}}) }}
            {{ form_errors(formStudent) }}
            <div class="modal-body px-6 py-4 space-y-6">
                <!-- Personal Information -->
                <div class="space-y-4">
                    <h5 class="text-sm font-medium text-gray-900 border-b border-gray-200 pb-2">Informations personnelles</h5>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            {{ form_label(formStudent.person.name, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(formStudent.person.name, {'attr': {'class': 'block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm'}}) }}
                            {{ form_errors(formStudent.person.name) }}
                        </div>
                        <div>
                            {{ form_label(formStudent.person.forname, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(formStudent.person.forname, {'attr': {'class': 'block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm'}}) }}
                            {{ form_errors(formStudent.person.forname) }}
                        </div>
                    </div>
                </div>

                <!-- Gender & Grade -->
                <div class="space-y-4">
                    <h5 class="text-sm font-medium text-gray-900 border-b border-gray-200 pb-2">{{ 'form.gender_grade.label'|trans }}</h5>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            {{ form_label(formStudent.person.gender, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(formStudent.person.gender, {'attr': {'class': 'block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm'}}) }}
                            {{ form_errors(formStudent.person.gender) }}
                        </div>
                        <div>
                            {{ form_label(formStudent.grade, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(formStudent.grade, {'attr': {'class': 'block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm'}}) }}
                            {{ form_errors(formStudent.grade) }}
                        </div>
                    </div>
                </div>

                <!-- Birth Information -->
                <div class="space-y-4">
                    <h5 class="text-sm font-medium text-gray-900 border-b border-gray-200 pb-2">{{ 'form.birthday_birthplace.label'|trans }}</h5>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            {{ form_label(formStudent.person.birthday, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(formStudent.person.birthday, {'attr': {'class': 'datepicker block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm'}}) }}
                            {{ form_errors(formStudent.person.birthday) }}
                        </div>
                        <div>
                            {{ form_label(formStudent.person.birthplace, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(formStudent.person.birthplace, {'attr': {'class': 'block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm'}}) }}
                            {{ form_errors(formStudent.person.birthplace) }}
                        </div>
                    </div>
                </div>

                <!-- Contact Information -->
                <div class="space-y-4">
                    <h5 class="text-sm font-medium text-gray-900 border-b border-gray-200 pb-2">{{ 'form.email_phone.label'|trans }}</h5>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            {{ form_label(formStudent.person.email, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(formStudent.person.email, {'attr': {'class': 'block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm', 'type': 'email'}}) }}
                            {{ form_errors(formStudent.person.email) }}
                        </div>
                        <div>
                            {{ form_label(formStudent.person.phone, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(formStudent.person.phone, {'attr': {'class': 'block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm'}}) }}
                            {{ form_errors(formStudent.person.phone) }}
                        </div>
                    </div>
                </div>

                {{ form_widget(formStudent.person.family, { "attr" : { "class" : "hidden" }}) }}

                <!-- School Information -->
                <div class="space-y-4">
                    <h5 class="text-sm font-medium text-gray-900 border-b border-gray-200 pb-2">Informations scolaires</h5>
                    <div>
                        {{ form_label(formStudent.lastSchool, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(formStudent.lastSchool, {'attr': {'class': 'block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm'}}) }}
                        {{ form_errors(formStudent.lastSchool) }}
                    </div>
                </div>

                <!-- Additional Information -->
                <div class="space-y-4">
                    <h5 class="text-sm font-medium text-gray-900 border-b border-gray-200 pb-2">Informations compl√©mentaires</h5>
                    <div>
                        {{ form_label(formStudent.remarksHealth, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(formStudent.remarksHealth, {'attr': {'class': 'block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm', 'rows': 3}}) }}
                        {{ form_errors(formStudent.remarksHealth) }}
                    </div>
                    <div>
                        {{ form_label(formStudent.personAuthorized, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(formStudent.personAuthorized, {'attr': {'class': 'block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm', 'rows': 3}}) }}
                        {{ form_errors(formStudent.personAuthorized) }}
                    </div>
                    <div class="flex items-center">
                        {{ form_widget(formStudent.letAlone, {'attr': {'class': 'h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded'}}) }}
                        <div class="ml-3">
                            {{ form_label(formStudent.letAlone, null, {'label_attr': {'class': 'text-sm font-medium text-gray-700'}}) }}
                        </div>
                        {{ form_errors(formStudent.letAlone) }}
                    </div>
                </div>
            </div>
                <div class="px-6 py-4 border-t border-gray-200 flex justify-end space-x-3">
                    <button type="button" @click="showModal = false" class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        {{ ux_icon('tabler:x', {class: 'w-4 h-4 mr-2'}) }}
                        Annuler
                    </button>
                    <button type="submit" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" id="save-student">
                        {{ ux_icon('tabler:check', {class: 'w-4 h-4 mr-2'}) }}
                        Enregistrer
                    </button>
                </div>

                {{ form_end(formStudent) }}
            </div>
        </div>
    </div>
</div>
