{% extends '_tailwind/layout.html.twig' %}

{% trans_default_domain "student" %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript" src="{{ asset('js/student.js') }}"></script>

    <script>
        $(function () {
            $('#modalFamily').on('shown.bs.modal', function () {

                var name = $('#app_student_person_name').val();
                var address = $('#app_student_person_address').val();
                var zip = $('#app_student_person_zip').val();
                var city = $('#app_student_person_city').val();
                var phone = $('#app_student_person_phone').val();

                $('#app_family_father_name').val(name);
                $('#app_family_address').val(address);
                $('#app_family_zip').val(zip);
                $('#app_family_city').val(city);
                $('#app_family_father_phone').val(phone);
            });

            $('#app_family_submit').click(function(e) {
                e.preventDefault();
                var form = $('form[name="app_family"]');
                var url = $(form).attr('action');
                var data = $(form).serializeArray();

                $.post(url, data)
                    .done(function (response) {
                        $('#app_student_person_family')
                            .append(new Option(response.data.label, response.data.id, true, true));

                        $('#modalFamily').modal('hide')
                    })
                    .always(function (data) {
                        console.log(data);
                    });
            });
        });
    </script>
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        /* Custom student-specific Tailwind overrides */
        .student-table th {
            @apply bg-gray-50 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider;
        }
        
        .student-table td {
            @apply px-6 py-4 whitespace-nowrap text-sm text-gray-900;
        }
        
        .student-row.danger {
            @apply bg-red-50 border-l-4 border-red-400;
        }
        
        .student-row.danger td {
            @apply text-red-700;
        }
        
        .dropdown-table {
            @apply relative z-10;
        }

        .comment-block footer {
            @apply bg-transparent;
        }

        .comment-text {
            @apply text-xs px-5 py-1 text-justify;
        }

        .tab-content {
            @apply pt-6;
        }
    </style>
{% endblock %}

{% block title %}
    {{ title }} - {{ parent() }}
{% endblock %}

{% set breadcrumbs = { ('title.common'|trans) : path('app_student_index')}|merge(breadcrumbs|default({})) %}

{% block menu_action %}
    <div class="flex flex-wrap gap-2 mb-6">
        {# Main navigation items #}
        <a href="{{ path('app_student_index') }}" 
           class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm 
                  {% if 'app_student_index' == app.request.attributes.get('_route') %}
                      text-white bg-primary-600 hover:bg-primary-700
                  {% else %}
                      text-gray-700 bg-white hover:bg-gray-50 border-gray-300
                  {% endif %} 
                  transition-colors duration-200">
            {{ ux_icon('bi:list-ul', {class: 'w-4 h-4 mr-2'}) }}
            <span class="hidden sm:inline">{% trans %}List{% endtrans %}</span>
        </a>

        <a href="{{ path('app_student_new') }}" 
           class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm
                  {% if 'app_student_new' == app.request.attributes.get('_route') %}
                      text-white bg-primary-600 hover:bg-primary-700
                  {% else %}
                      text-gray-700 bg-white hover:bg-gray-50 border-gray-300
                  {% endif %}
                  transition-colors duration-200">
            {{ ux_icon('bi:plus-lg', {class: 'w-4 h-4 mr-2'}) }}
            <span class="hidden sm:inline">{% trans %}New student{% endtrans %}</span>
        </a>

        <a href="{{ path('app_student_desactivated') }}" 
           class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm
                  {% if 'app_student_desactivated' == app.request.attributes.get('_route') %}
                      text-white bg-primary-600 hover:bg-primary-700
                  {% else %}
                      text-gray-700 bg-white hover:bg-gray-50 border-gray-300
                  {% endif %}
                  transition-colors duration-200">
            {{ ux_icon('bi:archive', {class: 'w-4 h-4 mr-2'}) }}
            <span class="hidden sm:inline">{% trans %}action.inactive_list{% endtrans %}</span>
        </a>

        <a href="{{ path('app_student_payment_list') }}" 
           class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm
                  {% if 'app_student_payment_list' == app.request.attributes.get('_route') %}
                      text-white bg-primary-600 hover:bg-primary-700
                  {% else %}
                      text-gray-700 bg-white hover:bg-gray-50 border-gray-300
                  {% endif %}
                  transition-colors duration-200">
            {{ ux_icon('bi:credit-card', {class: 'w-4 h-4 mr-2'}) }}
            <span class="hidden sm:inline">{% trans %}action.payment_list{% endtrans %}</span>
        </a>

        {% if student is defined and student.id %}
            {# Separator #}
            <div class="border-l border-gray-300 mx-2 hidden sm:block"></div>

            {# Student-specific actions #}
            <a href="{{ path('app_student_show', {'id': student.id}) }}" 
               class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm
                      {% if 'app_student_show' == app.request.attributes.get('_route') %}
                          text-white bg-primary-600 hover:bg-primary-700
                      {% else %}
                          text-gray-700 bg-white hover:bg-gray-50 border-gray-300
                      {% endif %}
                      transition-colors duration-200">
                {{ ux_icon('bi:eye', {class: 'w-4 h-4 mr-2'}) }}
                <span class="hidden sm:inline">{% trans %}Show{% endtrans %}</span>
            </a>

            <a href="{{ path('app_student_edit', {'id': student.id}) }}" 
               class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm
                      {% if 'app_student_edit' == app.request.attributes.get('_route') %}
                          text-white bg-primary-600 hover:bg-primary-700
                      {% else %}
                          text-gray-700 bg-white hover:bg-gray-50 border-gray-300
                      {% endif %}
                      transition-colors duration-200">
                {{ ux_icon('bi:pencil-square', {class: 'w-4 h-4 mr-2'}) }}
                <span class="hidden sm:inline">{% trans %}Edit{% endtrans %}</span>
            </a>

            <a href="{{ path('app_student_delete', {'id': student.id}) }}" 
               class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm
                      {% if 'app_student_delete' == app.request.attributes.get('_route') %}
                          text-white bg-red-600 hover:bg-red-700 border-red-600
                      {% else %}
                          text-red-700 bg-white hover:bg-red-50 border-red-300
                      {% endif %}
                      transition-colors duration-200">
                {{ ux_icon('bi:trash', {class: 'w-4 h-4 mr-2'}) }}
                <span class="hidden sm:inline">{% trans %}Delete{% endtrans %}</span>
            </a>
        {% endif %}
    </div>
{% endblock %}