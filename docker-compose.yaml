version: "3"
services:
    app:
        build: .
        image: app
        container_name: "${PROJECT_NAME}-app"
        restart: unless-stopped
        env_file:
            - ./docker/.env.docker
        environment:
            TZ: "Europe/Paris"
            APP_ENV : dev
            DATABASE_NAME : education_app
            DATABASE_PASSWORD : $PROJECT_DB_PASSWORD
        ports:
            - "${PROJECT_APP_PORT}:80"
        volumes:
            - ./docker/.env.app:/var/www/html/.env
            - ./public/uploads:/var/www/html/public/uploads

    nice:
        image: app
        container_name: "${PROJECT_NAME}-nice"
        restart: unless-stopped
        env_file:
            - ./docker/.env.docker
        depends_on:
            - app
        environment:
            TZ: "Europe/Paris"
            APP_ENV : dev
            DATABASE_NAME : education_nice
            DATABASE_PASSWORD : $PROJECT_DB_PASSWORD
        ports:
            - "${PROJECT_NICE_PORT}:80"
        volumes:
            - ./docker/.env.nice:/var/www/html/.env
            - ./public/uploads:/var/www/html/public/uploads

    db:
        image: mysql:latest
        container_name: "${PROJECT_NAME}-db"
        command: --default-authentication-plugin=mysql_native_password --sql_mode=""
        restart: unless-stopped
        environment:
            MYSQL_ROOT_PASSWORD: ${PROJECT_DB_PASSWORD}
        ports:
            - "${PROJECT_DB_PORT}:3306"
